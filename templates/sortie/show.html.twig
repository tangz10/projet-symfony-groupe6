{% extends 'base.html.twig' %}

{% block title %}Afficher une sortie{% endblock %}

{% block body %}
    <div class="flex-1 overflow-y-auto">
        <div class="max-w-5xl mx-auto px-4 py-6">
            <div class="bg-white/95 backdrop-blur rounded-2xl shadow-xl p-6 md:p-8">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6">
                    <h1 class="text-2xl md:text-3xl font-semibold text-gray-800">Afficher une sortie</h1>
                    <a href="{{ path('app_sortie_index') }}"
                       class="inline-flex items-center h-11 px-5 rounded-full bg-purple-600 text-white hover:bg-purple-700 shadow">
                        ← Retour à la liste
                    </a>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-4">
                    <div class="space-y-3">
                        <div class="flex items-baseline gap-2">
                            <span class="w-44 text-sm text-gray-600">Nom de la sortie :</span>
                            <span class="text-gray-900 font-medium">{{ s.nom }}</span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-44 text-sm text-gray-600">Date et heure de la sortie :</span>
                            <span class="text-gray-900">
                              {{ s.dateHeureDebut ? s.dateHeureDebut|date('d/m/Y H:i') : '—' }}
                            </span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-44 text-sm text-gray-600">Date limite d'inscription :</span>
                            <span class="text-gray-900">
                              {{ s.dateLimiteInscription ? s.dateLimiteInscription|date('d/m/Y') : '—' }}
                            </span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-44 text-sm text-gray-600">Nombre de places :</span>
                            <span class="text-gray-900">
                              {{ s.nbInscriptionsMax is not null ? s.nbInscriptionsMax : '—' }}
                            </span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-44 text-sm text-gray-600">Durée :</span>
                            <span class="text-gray-900">
                              {{ s.duree is not null ? s.duree ~ ' minutes' : '—' }}
                            </span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-44 text-sm text-gray-600">Description et infos :</span>
                            <span class="text-gray-900">{{ s.infosSortie ?: '—' }}</span>
                        </div>
                    </div>

                    <div class="space-y-3">
                        <div class="flex items-baseline gap-2">
                            <span class="w-40 text-sm text-gray-600">Lieu :</span>
                            <span class="text-gray-900">{{ s.lieu ? s.lieu.nom : '—' }}</span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-40 text-sm text-gray-600">Rue :</span>
                            <span class="text-gray-900">{{ s.lieu ? s.lieu.rue : '—' }}</span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-40 text-sm text-gray-600">Ville :</span>
                            <span class="text-gray-900">{{ s.lieu and s.lieu.ville ? s.lieu.ville.nom : '—' }}</span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-40 text-sm text-gray-600">Code postal :</span>
                            <span class="text-gray-900">{{ s.lieu and s.lieu.ville ? s.lieu.ville.codePostal : '—' }}</span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-40 text-sm text-gray-600">Latitude :</span>
                            <span class="text-gray-900">{{ s.lieu ? s.lieu.latitude : '—' }}</span>
                        </div>

                        <div class="flex items-baseline gap-2">
                            <span class="w-40 text-sm text-gray-600">Longitude :</span>
                            <span class="text-gray-900">{{ s.lieu ? s.lieu.longitude : '—' }}</span>
                        </div>
                    </div>
                </div>

                <div class="mt-8">
                    <h2 class="text-lg font-semibold text-gray-800 mb-3">Liste des participants inscrits :</h2>

                    <div class="border border-gray-200 rounded-xl overflow-hidden">
                        <div class="max-h-64 overflow-y-auto">
                            <table class="min-w-full divide-y divide-gray-200 bg-white">
                                <thead class="bg-gray-50">
                                <tr class="text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    <th class="px-4 py-2 w-32">Pseudo</th>
                                    <th class="px-4 py-2">Nom</th>
                                </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-100">
                                {% for p in s.participantInscrit %}
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-4 py-2 text-gray-800">{{ p.prenom|slice(0,1) ~ p.nom|slice(0,1) }}</td>
                                        <td class="px-4 py-2 text-gray-800">{{ p.prenom }} {{ p.nom }}</td>
                                    </tr>
                                {% else %}
                                    <tr>
                                        <td colspan="2" class="px-4 py-4 text-center text-gray-500">Aucun participant pour le moment.</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="mt-10 flex flex-col sm:flex-row justify-center gap-4">
                        <a href="{{ path('app_sortie_index') }}"
                           class="h-11 px-6 flex items-center justify-center rounded-full border border-gray-300 bg-white hover:bg-gray-100 text-gray-700 shadow">
                            Retour
                        </a>

                        {% if me %}
                            {% set inscrit = s.participantInscrit.contains(me) %}
                            {% if not inscrit %}
                                <a href=""
                                   class="h-11 px-6 flex items-center justify-center rounded-full bg-green-700 text-white hover:bg-green-700 shadow">
                                    S’inscrire
                                </a>
                            {% else %}
                                <a href=""
                                   class="h-11 px-6 flex items-center justify-center rounded-full bg-red-700 text-white hover:bg-red-700 shadow">
                                    Se désister
                                </a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>

            </div>
        </div>
    </div>
{% endblock %}
